# Configuracao do framework topsys.

JNDI.CONNECTION java:comp/env/jdbc/ZapeatSiteDS

CLASS.BROKER.IMPL br.com.topsys.database.jdbc.TSDataBaseBrokerImpl

CLASS.SEQUENCE.IMPL br.com.topsys.database.jdbc.sequence.TSSequencePostgresImpl

CODIGO.UNIQUE 23505

CODIGO.FOREIGNKEY 23503

CODIGO.RAISE.EXCEPTION 09000

#ComentarioDAO
comentariodao.inserir=INSERT INTO PUBLIC.COMENTARIOS (USUARIO_ID, FORNECEDOR_ID, DESCRICAO, DATA_CADASTRO, FLAG_INDICA_ATENDIMENTO, FLAG_INDICA_PROMOCAO, FLAG_NAO_INDICA) VALUES (?, ?, ?, CURRENT_TIMESTAMP, ?, ?, ?)
comentariodao.obterIndicacaoEstabelecimento=SELECT C.ID, C.DESCRICAO, US.NOME, F.ID, F.NOME_FANTASIA, (SELECT IMAGEM FROM IMAGENS_FORNECEDORES IF WHERE IF.FORNECEDOR_ID = F.ID ORDER BY RANDOM() LIMIT 1) FROM COMENTARIOS C, USUARIOS_SITE US, FORNECEDORES F WHERE C.USUARIO_ID = US.ID AND C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_ATENDIMENTO AND F.FLAG_ATIVO ORDER BY RANDOM() LIMIT 1
comentariodao.rankingEstabelecimento=SELECT POSICAO_RANK, A.ID, A.NOME_FANTASIA, A.LOGOMARCA FROM (SELECT RANK() OVER (ORDER BY F.ID DESC) AS POSICAO_RANK, F.ID, F.NOME_FANTASIA, F.LOGOMARCA FROM FORNECEDORES F LEFT OUTER JOIN COMENTARIOS C ON C.FORNECEDOR_ID = F.ID WHERE F.FLAG_ATIVO GROUP BY F.ID, F.NOME_FANTASIA, F.LOGOMARCA ) AS A WHERE ID = ?
comentariodao.obterIndicacaoComidaPositiva=SELECT C.ID, C.DESCRICAO, US.ID, US.NOME, F.ID, F.NOME_FANTASIA, F.LOGOMARCA FROM COMENTARIOS C, USUARIOS_SITE US, FORNECEDORES F WHERE C.USUARIO_ID = US.ID AND C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND F.ID = ? AND C.USUARIO_ID = ? ORDER BY RANDOM() LIMIT 1
comentariodao.obterIndicacaoComidaNegativa=SELECT C.ID, C.DESCRICAO, US.ID, US.NOME, F.ID, F.NOME_FANTASIA, F.LOGOMARCA FROM COMENTARIOS C, USUARIOS_SITE US, FORNECEDORES F WHERE C.USUARIO_ID = US.ID AND C.FORNECEDOR_ID = F.ID AND C.FLAG_NAO_INDICA AND F.ID = ? AND C.USUARIO_ID = ? ORDER BY RANDOM() LIMIT 1
comentariodao.obterIndicacaoEstabelecimentoPorUsuario=SELECT C.ID, C.DESCRICAO, US.ID, US.NOME, F.ID, F.NOME_FANTASIA, F.LOGOMARCA FROM COMENTARIOS C, USUARIOS_SITE US, FORNECEDORES F WHERE C.USUARIO_ID = US.ID AND C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_ATENDIMENTO AND F.ID = ? AND C.USUARIO_ID = ? ORDER BY RANDOM() LIMIT 1

#FornecedorDAO
fornecedordao.obter=SELECT F.ID, F.RAZAO_SOCIAL, F.CNPJ, F.NOME_FANTASIA, F.CEP, F.LOGRADOURO, F.NUMERO, F.BAIRRO, F.CIDADE_ID, F.LATITUDE, F.LONGITUDE, F.LOGOMARCA, F.FLAG_ATIVO, F.DESCRICAO, F.HORARIOS_FUNCIONAMENTO, F.TWITTER, F.FACEBOOK, F.SITE, F.TELEFONE, SUM(CASE WHEN C.FLAG_INDICA_ATENDIMENTO THEN 1 ELSE 0 END) AS TOTAL, (SELECT IMAGEM FROM IMAGENS_FORNECEDORES IF WHERE IF.FORNECEDOR_ID = F.ID ORDER BY RANDOM() LIMIT 1) FROM PUBLIC.FORNECEDORES F LEFT OUTER JOIN COMENTARIOS C ON C.FORNECEDOR_ID = F.ID WHERE F.ID = ? AND F.FLAG_ATIVO GROUP BY F.ID,F.RAZAO_SOCIAL, F.CNPJ, F.NOME_FANTASIA, F.CEP, F.LOGRADOURO, F.NUMERO, F.BAIRRO, F.CIDADE_ID, F.LATITUDE, F.LONGITUDE, F.LOGOMARCA, F.FLAG_ATIVO, F.DESCRICAO, F.HORARIOS_FUNCIONAMENTO, F.TWITTER, F.FACEBOOK, F.SITE, F.TELEFONE
fornecedordao.pesquisarHome=SELECT ID, LOGOMARCA, NOME_FANTASIA FROM PUBLIC.FORNECEDORES WHERE FLAG_ATIVO ORDER BY RANDOM() LIMIT 6
fornecedordao.pesquisarTopGeral=SELECT F.ID, F.NOME_FANTASIA, SUM(CASE WHEN FLAG_INDICA_ATENDIMENTO THEN 1 ELSE 0 END + CASE WHEN FLAG_INDICA_PROMOCAO THEN 1 ELSE 0 END) TOTAL FROM PUBLIC.COMENTARIOS C, FORNECEDORES F WHERE C.FORNECEDOR_ID = F.ID AND F.FLAG_ATIVO GROUP BY F.ID, F.NOME_FANTASIA ORDER BY TOTAL DESC LIMIT 5
fornecedordao.pesquisarMelhorAtendimento=SELECT F.ID, F.NOME_FANTASIA, SUM(CASE WHEN FLAG_INDICA_ATENDIMENTO THEN 1 ELSE 0 END) TOTAL, (SELECT IMAGEM FROM IMAGENS_FORNECEDORES IF WHERE IF.FORNECEDOR_ID = F.ID ORDER BY RANDOM() LIMIT 1), CAT.ID, CAT.DESCRICAO FROM PUBLIC.COMENTARIOS C, FORNECEDORES F, FORNECEDORES_CATEGORIAS FC, CATEGORIAS CAT WHERE C.FORNECEDOR_ID = F.ID AND FC.FORNECEDOR_ID = F.ID AND FC.CATEGORIA_ID = CAT.ID AND FC.CATEGORIA_ID = ? AND F.FLAG_ATIVO GROUP BY F.ID, F.NOME_FANTASIA, F.LOGOMARCA, CAT.ID, CAT.DESCRICAO ORDER BY TOTAL DESC LIMIT 5
fornecedordao.pesquisarMelhorComida=SELECT F.ID, F.NOME_FANTASIA, SUM(CASE WHEN FLAG_INDICA_PROMOCAO THEN 1 ELSE 0 END) TOTAL, (SELECT IMAGEM FROM IMAGENS_FORNECEDORES IF WHERE IF.FORNECEDOR_ID = F.ID ORDER BY RANDOM() LIMIT 1), CAT.ID, CAT.DESCRICAO FROM PUBLIC.COMENTARIOS C, FORNECEDORES F, FORNECEDORES_CATEGORIAS FC, CATEGORIAS CAT WHERE C.FORNECEDOR_ID = F.ID AND FC.FORNECEDOR_ID = F.ID AND FC.CATEGORIA_ID = CAT.ID AND FC.CATEGORIA_ID = ? AND F.FLAG_ATIVO GROUP BY F.ID, F.NOME_FANTASIA, F.LOGOMARCA, CAT.ID, CAT.DESCRICAO ORDER BY TOTAL DESC LIMIT 5
fornecedordao.pesquisarporcategoria=SELECT DISTINCT F.ID, F.LOGOMARCA, F.NOME_FANTASIA, F.DESCRICAO, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES, row_number() over() FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE CAT.ID = COALESCE(?, CAT.ID) ORDER BY NOME_FANTASIA LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
fornecedordao.obterqtdpaginasporcategoria=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE CAT.ID = COALESCE(?, CAT.ID)
fornecedordao.pesquisaporcategoriamaisindicadas=SELECT DISTINCT F.ID, F.LOGOMARCA, F.NOME_FANTASIA, F.DESCRICAO, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES, row_number() over() FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID AND PRIORIDADE = 1 INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID ORDER BY INDICACOES DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
fornecedordao.pesquisaporcategoriaoutrascategorias=SELECT DISTINCT F.ID, F.LOGOMARCA, F.NOME_FANTASIA, F.DESCRICAO, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES, row_number() over() FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID AND PRIORIDADE = 1 INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID ORDER BY INDICACOES DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
fornecedordao.pesquisarqtdpaginasporcategoriamaisindicados=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID AND PRIORIDADE = 1 INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID
fornecedordao.pesquisarqtdpaginasporcategoriaoutrascategorias=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID AND PRIORIDADE = 1 INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID

#ImagemFornecedorDAO
imagemfornecedordao.pesquisar=SELECT ID, FORNECEDOR_ID, IMAGEM FROM IMAGENS_FORNECEDORES WHERE FORNECEDOR_ID = ? ORDER BY RANDOM() LIMIT 3

#ImagemPromocaoDAO
imagempromocaodao.pesquisar=SELECT ID, PROMOCAO_ID, IMAGEM FROM IMAGENS_PROMOCOES WHERE PROMOCAO_ID = ? 

#ImagemCarroChefeDAO
imagemcarrochefedao.pesquisar=SELECT ID, CARRO_CHEFE_ID, IMAGEM FROM IMAGENS_CARROS_CHEFES WHERE CARRO_CHEFE_ID = ? 

#PromocaoDAO
promocaodao.pesquisarporindicacoes=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, P.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, P.DESCRICAO, P.TITULO, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES, row_number() over() FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON TP.ID = P.TIPO_PROMOCAO_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.ID = P.FORNECEDOR_CATEGORIA_ID INNER JOIN FORNECEDORES F ON F.ID = FC.FORNECEDOR_ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE TP.ID = COALESCE(?, TP.ID) AND FC.CATEGORIA_ID = COALESCE(?, FC.CATEGORIA_ID) ORDER BY P.TITULO DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
promocaodao.pesquisarporindicacoesmaisindicados=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, P.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, P.DESCRICAO, P.TITULO, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES, row_number() over() FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON TP.ID = P.TIPO_PROMOCAO_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.ID = P.FORNECEDOR_CATEGORIA_ID INNER JOIN FORNECEDORES F ON F.ID = FC.FORNECEDOR_ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE TP.ID = COALESCE(?, TP.ID) ORDER BY INDICACOES DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
promocaodao.pesquisarqtdpaginasporindicacoes=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON TP.ID = P.TIPO_PROMOCAO_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.ID = P.FORNECEDOR_CATEGORIA_ID INNER JOIN FORNECEDORES F ON F.ID = FC.FORNECEDOR_ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE TP.ID = COALESCE(?, TP.ID) AND FC.CATEGORIA_ID = COALESCE(?, FC.CATEGORIA_ID)
promocaodao.pesquisarqtdpaginasporindicacoesmaisindicados=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON TP.ID = P.TIPO_PROMOCAO_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.ID = P.FORNECEDOR_CATEGORIA_ID INNER JOIN FORNECEDORES F ON F.ID = FC.FORNECEDOR_ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE TP.ID = COALESCE(?, TP.ID)
promocaodao.obterPromocaoHora=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, FC.FORNECEDOR_ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, F.LONGITUDE, F.LATITUDE, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LOGOMARCA FROM PUBLIC.PROMOCOES P, TIPOS_PROMOCOES TP, FORNECEDORES F, FORNECEDORES_CATEGORIAS FC WHERE P.TIPO_PROMOCAO_ID = TP.ID AND P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.FORNECEDOR_ID = F.ID AND P.TIPO_PROMOCAO_ID = 1 AND CURRENT_TIMESTAMP BETWEEN P.INICIO AND P.FIM ORDER BY RANDOM() LIMIT 1
promocaodao.pesquisarPromocoesHora=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, FC.FORNECEDOR_ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, F.LONGITUDE, F.LATITUDE, F.SITE, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_PROMOCAO) AS INDICACOES, F.TELEFONE, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1) FROM PUBLIC.PROMOCOES P, TIPOS_PROMOCOES TP, FORNECEDORES F, FORNECEDORES_CATEGORIAS FC WHERE P.TIPO_PROMOCAO_ID = TP.ID AND P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.FORNECEDOR_ID = F.ID AND P.TIPO_PROMOCAO_ID = 1 AND CURRENT_TIMESTAMP BETWEEN P.INICIO AND P.FIM AND P.ID <> ? ORDER BY RANDOM() LIMIT 6
promocaodao.obterpromocaohoraaleatoria=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, F.ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LONGITUDE, F.LATITUDE FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON P.TIPO_PROMOCAO_ID = TP.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.PRIORIDADE = 1 INNER JOIN FORNECEDORES F ON FC.FORNECEDOR_ID = F.ID WHERE TP.ID = 1 AND CURRENT_TIMESTAMP BETWEEN P.INICIO AND P.FIM ORDER BY RANDOM() LIMIT 1
promocaodao.obterPromocaoDia=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, F.ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LONGITUDE, F.LATITUDE FROM PUBLIC.PROMOCOES P, TIPOS_PROMOCOES TP, FORNECEDORES_CATEGORIAS FC, FORNECEDORES F WHERE P.TIPO_PROMOCAO_ID = TP.ID AND P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.FORNECEDOR_ID = F.ID AND P.TIPO_PROMOCAO_ID = 2 AND DATE_TRUNC ('DAY', P.INICIO) = CURRENT_DATE AND FC.FORNECEDOR_ID = COALESCE(?, FC.FORNECEDOR_ID) AND FC.FORNECEDOR_ID > 0 ORDER BY RANDOM() LIMIT 1
promocaodao.obterpromocaodiaaleatoria=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, F.ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LONGITUDE, F.LATITUDE FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON P.TIPO_PROMOCAO_ID = TP.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.PRIORIDADE = 1 INNER JOIN FORNECEDORES F ON FC.FORNECEDOR_ID = F.ID WHERE TP.ID = 2 AND CURRENT_TIMESTAMP BETWEEN P.INICIO AND P.FIM ORDER BY RANDOM() LIMIT 1
promocaodao.obterPromocaoSemana=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, FC.FORNECEDOR_ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LONGITUDE, F.LATITUDE FROM      PUBLIC.PROMOCOES P, TIPOS_PROMOCOES TP, FORNECEDORES F, FORNECEDORES_CATEGORIAS FC WHERE P.TIPO_PROMOCAO_ID = TP.ID AND P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.FORNECEDOR_ID = F.ID     AND P.TIPO_PROMOCAO_ID = 3 AND CURRENT_DATE BETWEEN DATE_TRUNC ('DAY', P.INICIO) AND DATE_TRUNC('DAY', P.FIM) AND FC.FORNECEDOR_ID = COALESCE(?, FC.FORNECEDOR_ID) AND FC.FORNECEDOR_ID > 0 ORDER BY RANDOM() LIMIT 1
promocaodao.obterpromocaosemanaaleatoria=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, F.ID, F.NOME_FANTASIA, P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), F.LONGITUDE, F.LATITUDE FROM PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON P.TIPO_PROMOCAO_ID = TP.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON P.FORNECEDOR_CATEGORIA_ID = FC.ID AND FC.PRIORIDADE = 1 INNER JOIN FORNECEDORES F ON FC.FORNECEDOR_ID = F.ID WHERE TP.ID = 3 AND CURRENT_TIMESTAMP BETWEEN P.INICIO AND P.FIM ORDER BY RANDOM() LIMIT 1
promocaodao.obter=SELECT P.ID, P.TIPO_PROMOCAO_ID, TP.DESCRICAO, P.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.HORARIOS_FUNCIONAMENTO, F.LOGRADOURO, F.NUMERO, F.BAIRRO, F.TELEFONE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, (SELECT IMAGEM FROM IMAGENS_PROMOCOES IP WHERE IP.PROMOCAO_ID = P.ID ORDER BY RANDOM() LIMIT 1), P.DESCRICAO, P.INICIO, P.FIM, P.PRECO_ORIGINAL, P.PRECO_PROMOCIONAL, P.TITULO, F.LONGITUDE, F.LATITUDE FROM PUBLIC.PROMOCOES P INNER JOIN TIPOS_PROMOCOES TP ON TP.ID = P.TIPO_PROMOCAO_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.ID = P.FORNECEDOR_CATEGORIA_ID INNER JOIN FORNECEDORES F ON F.ID = FC.FORNECEDOR_ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE P.ID = COALESCE(?, (SELECT ID FROM PROMOCOES P1 WHERE CURRENT_DATE BETWEEN P1.INICIO AND P1.FIM ORDER BY RANDOM() LIMIT 1)) 

#UsuarioDAO
usuariodao.inserir=INSERT INTO PUBLIC.USUARIOS_SITE (ID, NOME, EMAIL, SENHA, FLAG_ATIVO, IMAGEM, TOKEN) VALUES (?, ?, ?, ?, ?, ?, ?)
usuariodao.obter=SELECT ID, NOME, EMAIL, SENHA, FLAG_ATIVO, IMAGEM FROM PUBLIC.USUARIOS_SITE WHERE EMAIL = ?
usuariodao.alterar=UPDATE PUBLIC.USUARIOS_SITE SET NOME = ? WHERE ID = ?

#BuscaDAO
buscadao.pesquisarportexto=SELECT row_number() over(), * FROM FC_BUSCAR(?, ?) LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
buscadao.obterqtdpaginasportexto=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM FC_BUSCAR(?, ?)
buscadao.pesquisarpromocaoportexto=SELECT DISTINCT P.TITULO, F.RAZAO_SOCIAL, P.DESCRICAO, 2, CAT.DESCRICAO, F.TELEFONE, F.SITE, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = P.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES FROM PROMOCOES P INNER JOIN FORNECEDORES F ON F.id = P.FORNECEDOR_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON FC.CATEGORIA_ID = CAT.ID WHERE F.DESCRICAO ILIKE COALESCE(?, F.DESCRICAO)
buscadao.pesquisarcarrochefeportexto=SELECT DISTINCT CC.TITULO, F.RAZAO_SOCIAL, CC.DESCRICAO, 2, CAT.DESCRICAO, F.TELEFONE, F.SITE FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON F.ID = CC.FORNECEDOR_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON FC.CATEGORIA_ID = CAT.ID WHERE CC.DESCRICAO ILIKE COALESCE(?, CC.DESCRICAO)
buscadao.pesquisarestabelecimentoportexto=SELECT DISTINCT F.RAZAO_SOCIAL, F.LOGRADOURO || ', ' || F.BAIRRO, F.DESCRICAO, 1, CAT.DESCRICAO, F.TELEFONE, F.SITE, (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = P.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES FROM FORNECEDORES F INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON FC.CATEGORIA_ID = CAT.ID LEFT OUTER JOIN PROMOCOES P ON P.FORNECEDOR_ID = F.ID WHERE F.DESCRICAO ILIKE COALESCE(?, F.DESCRICAO)

#CidadeDAO
cidadedao.pesquisar=SELECT ID, NOME FROM CIDADES WHERE NOME ILIKE COALESCE(?, NOME)
cidadedao.pesquisartodos=SELECT ID, NOME FROM CIDADES ORDER BY NOME
cidadedao.obter=SELECT ID, NOME FROM CIDADES WHERE ID = ?

#CarroChefeDAO
carrochefedao.pesquisaporcategoria=SELECT CC.ID, CC.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, CC.DESCRICAO, CC.TITULO, row_number() over() FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE FC.CATEGORIA_ID = COALESCE(?, FC.CATEGORIA_ID) ORDER BY CC.TITULO LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
carrochefedao.pesquisaporcategoriamaisindicados=SELECT CC.ID, CC.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CC.DESCRICAO, CC.TITULO, row_number() over(), (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID ORDER BY INDICACOES DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
carrochefedao.pesquisaporcategoriaoutrascategorias=SELECT CC.ID, CC.FORNECEDOR_ID, F.NOME_FANTASIA, F.LOGOMARCA, F.TELEFONE, F.SITE, F.LATITUDE, F.LONGITUDE, CAT.ID, CAT.DESCRICAO, CC.DESCRICAO, CC.TITULO, row_number() over(), (SELECT COUNT(*) FROM COMENTARIOS C WHERE C.FORNECEDOR_ID = F.ID AND C.FLAG_INDICA_PROMOCAO AND C.FLAG_INDICA_ATENDIMENTO) AS INDICACOES FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID AND NOT CAT.FLAG_DESTAQUE ORDER BY INDICACOES DESC LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
carrochefedao.pesquisarqtdpaginasporcategoria=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE FC.CATEGORIA_ID = COALESCE(?, FC.CATEGORIA_ID)
carrochefedao.pesquisarqtdpaginasporcategoriamaisindicados=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID 
carrochefedao.pesquisarqtdpaginasporcategoriaoutrascategorias=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID AND NOT CAT.FLAG_DESTAQUE
carrochefedao.obter=SELECT CC.ID, F.ID, F.NOME_FANTASIA, F.LOGOMARCA, F.HORARIOS_FUNCIONAMENTO, F.LOGRADOURO, F.NUMERO, F.BAIRRO, F.TELEFONE, CAT.ID, CAT.DESCRICAO, CAT.IMAGEM, (SELECT IMAGEM FROM IMAGENS_CARROS_CHEFES ICC WHERE ICC.CARRO_CHEFE_ID = CC.ID ORDER BY RANDOM() LIMIT 1), CC.DESCRICAO, CC.TITULO, F.LONGITUDE, F.LATITUDE FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON F.ID = CC.FORNECEDOR_ID INNER JOIN FORNECEDORES_CATEGORIAS FC ON FC.FORNECEDOR_ID = F.ID AND FC.PRIORIDADE = 1 INNER JOIN CATEGORIAS CAT ON CAT.ID = FC.CATEGORIA_ID WHERE CC.ID = ? 
carrochefedao.obtercarrochefealeatorio=SELECT CC.ID, CC.FORNECEDOR_ID, F.NOME_FANTASIA, CC.DESCRICAO, CC.FLAG_ATIVO, CC.TITULO, (SELECT I.IMAGEM FROM IMAGENS_CARROS_CHEFES I WHERE I.CARRO_CHEFE_ID = CC.ID ORDER BY RANDOM() DESC LIMIT 1) AS IMAGEM_CARRO_CHEFE FROM CARROS_CHEFES CC INNER JOIN FORNECEDORES F ON CC.FORNECEDOR_ID = F.ID AND CC.FLAG_ATIVO ORDER BY RANDOM() LIMIT 1  

#CategoriaDAO
categoriadao.obter=SELECT ID, DESCRICAO, IMAGEM FROM CATEGORIAS WHERE ID = ?
categoriadao.pesquisar=SELECT ID, DESCRICAO, FLAG_ATIVO, IMAGEM, FLAG_DESTAQUE FROM PUBLIC.CATEGORIAS WHERE FLAG_ATIVO AND FLAG_DESTAQUE ORDER BY FLAG_DESTAQUE DESC, DESCRICAO LIMIT 6
categoriadao.pesquisaroutrascategorias=SELECT ID, DESCRICAO, FLAG_ATIVO, IMAGEM, FLAG_DESTAQUE FROM PUBLIC.CATEGORIAS WHERE FLAG_ATIVO AND NOT FLAG_DESTAQUE ORDER BY DESCRICAO LIMIT 6 OFFSET(COALESCE(?, 1) - 1) * 6
categoriadao.obterqtdpaginasoutrascategorias=SELECT CASE WHEN MOD(COUNT(*) ,6) > 0 THEN COUNT(*)/6+1 ELSE COUNT(*)/6 END FROM PUBLIC.CATEGORIAS WHERE FLAG_ATIVO AND NOT FLAG_DESTAQUE

#BannerDAO
bannerdao.obterbannertopo=SELECT B.ID, B.IMAGEM FROM BANNERS B WHERE B.FLAG_ATIVO AND B.TIPO_BANNER_ID = 1 AND CURRENT_DATE BETWEEN B.INICIO AND B.FIM ORDER BY B.TAXA_PRIORIDADE ASC, RANDOM() LIMIT 1
bannerdao.obterbannerlateral=SELECT B.ID, B.IMAGEM FROM BANNERS B WHERE B.FLAG_ATIVO AND B.TIPO_BANNER_ID = 2 AND CURRENT_DATE BETWEEN B.INICIO AND B.FIM ORDER BY B.TAXA_PRIORIDADE ASC, RANDOM() LIMIT 1

#FormaPagaamentoDAO
formapagamentodao.pesquisar=SELECT FP.ID, FP.DESCRICAO, FP.IMAGEM FROM FORMAS_PAGAMENTOS FP INNER JOIN FORNECEDORES_FORMAS_PAGAMENTOS FFP ON FP.ID = FFP.FORMA_PAGAMENTO_ID WHERE FFP.FORNECEDOR_ID = ?

